

# Задача разделения фейковых и реальных комментариев Wildberries
В репозитории представлен анализ данных и процесс разработки решения, а также готовый проект.

<!-- данные -->
## 1. Данные
Для разделения используются данные в формате: 3 уникальных идентификатора, 8 числовых признаков и текст комментария (в случае обучения - еще колонка с метками).

<!-- модель -->
## 2. Модель
Используется модель логистической регрессии. 

<!-- файлы -->
## 3. Файлы
* **requirements.txt**: Список необходимых библиотек для запуска проекта.

* **src**: Содержит программы для запуска проекта. 
    * **src/features**: Содержит скрипты для предобработки данных
        * **features/utils**: Вспомогательные функции для предобработки текста.
        * **features/preprocessing**: Содержит класс Preprocessing, осуществляющий предобработку данных для обучения модели. Обогащение исходных данных попарными делениями числовых признаков (кроме деления на признаки, в которых есть 0) и текстовыми признаками: количество знаков препинания, количество слов, начинающихся с большой буквы, средняя длина слова в комментарии, количество слов, среднее количество слов, начинающихся с большой буквы и среднее количество знаков препинания в пересчете на количество слов. 
        * **features/data_features**: Содержит функцию make_processed_data(), осуществляющую предобработку данных и их сохранение в ./data/ в зависимости от режима (Train/Inference).
    * **src/models**: Содержит скрипты для работы модели.
        * **features/params**: Содержит класс Parameters, содержащий параметры модели и порог.
        * **features/model**: Содержит класс Model, осуществляющий инициализацию модели.
        * **features/train_model**: Содержит функцию train_model(), осуществляющую обучение модели на размеченных данных и ее сохранение в папку ./models.
        * **features/data_features**: Содержит функцию predict_model(), осуществляющую применение модели к неразмеченных данных и сохранение результатов в ./models.

* **data**: Содержит сырые и предобработанные данные 
    * **raw/train/**: Содержит сырые данные для обучения (размеченные). Перед обучением они должны быть загружены. 
    * **raw/inference/**: Содержит сырые данные для применения (неразмеченные). Перед применением они должны быть загружены. 
    * **processed/train/**: Содержит данные для обучения после предобработки.
    * **processed/inference/**: Содержит данные для применения после предобработки.
    * **data_analysis.csv**: Данные, используемые для анализа и разработки (см. ./notebooks/)
    
* **models**: Содержит результат обучения (модель) и результат применения (предсказания модели).

* **reports**: Содержит данные для отчетности.

* **notebooks**: Содержит Jupyter Notebooks, показывающие развитие проекта. 
    * **1-zaretskii-EDA_L0-L3.ipynb**: Содержит EDA, формализацию задачи, анализ исходных данных.
    * **2.1-zaretskii-baseline-and-models-L4.ipynb**: Содержит формирование baseline, подбор и проверку возможных решений на простых моделях.
    * **2.2-zaretskii-Text_CNN.ipynb**: Содержит формирование ансамбля CNN, обученной на предобработанном с помощью BERT тексте, и модели, обученной на числовых признаках.
    * **3-zaretskii-evaluation-tuning-L5.ipynb**: Содержит подбор гиперпараметров для выбранных решений и выбор конечной модели. 
    * **4-zaretskii-chosen_model_NoOutliers.ipynb**: Содержит обучение выбранной модели на данных без выбросов.
    
* **run.py**: Файл с аргументами, заданными в консоли, запускающий проект.  
    * **path**: путь к папке с проектом (обязательный аргумент).
    * **mode**: режим работы (Train/Inference/Default (оба последовательно)).
    * **data_name**: название файла с данными.
    * **label_column**: название колонки с метками.
    * **text_column**: название колонки с текстом. 
    * **model_name**: название обученной модели (для режима inference).




<!-- how-to-use -->
## 3. Использование
Установка нужных расширений:

```SH
pip install -r requirements.txt
```

Conda:
```SH
conda install pip
pip install -r requirements.txt
```



Параметры можно вручную изменить в файле ./src/model/params

```PY
class Parameters:
   threshold : float = 0.7
   C: int = 1
   class_weight: str = 'balanced' 
   dual: bool = False
   fit_intercept: bool = False 
   intercept_scaling: int =  1
   max_iter: int = 1000 
   penalty: str = 'l1'
   solver: str = 'liblinear' 
   tol: float = 0.001
   warm_start: bool = False
```
 
Помощь в запуске модели:
```SH
python3 run.py -h
```

Пример запуска модели: 

```SH
python3 run.py -p /Users/nzaretski/Desktop/education/wildberries/script/wb_school
```
